@using Syncfusion.JavaScript;

@section SampleHeading{
    <span class="sampleName">Excel Export</span>
}
@section MetaTags{
    <meta name="description" content="This example shows how the ASP.NET Core Scheduler exports appointments to an Excel file.">
}
@section ControlsSection{
    <div>
		<ej-button id="btnExport" text="Export To Excel" height="25px" click="onExportClick" />
        <ej-schedule id="Schedule1" width="100%" height="525px" current-date="new DateTime(2017, 6, 5)">
            <e-appointment-settings datasource="@ViewBag.appointments" subject='"Subject"' start-time='"StartTime"' end-time='"EndTime"' all-day='"AllDay"' recurrence='"Recurrence"' recurrence-rule='"RecurrenceRule"'></e-appointment-settings>
        </ej-schedule>
    </div>
}

@section ScriptSection{
    <script type="text/javascript">
        $(function () {
            $("#Schedule1").find("tr.e-scheduleheader td").first().append($("#btnExport"));
        });

        function onExportClick(args) {
            var proxy = $("#Schedule1").data("ejSchedule");
            proxy.exportToExcel("ExportAsExcel", null, false);
        }
    </script>
}

@section StyleSection{
    <style type="text/css">
        .e-schedule #btnExport {
            position: absolute;
            left: 49%;
            top: 2%;
        }
    </style>
}